<project>
<div class="row">
  <div class="col-md-12">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class='panel-title'>New Project</h3>
      </div>
      <div class="panel-body">
        	<form onsubmit={ add }>
        <div class="row">
          <div class="col-md-5">
            <div class="form-group">
              <label>
                Select a project!
              </label>
              <select multiple class="form-control">
                <option each={ projects } onclick = { selectCurrentProject }>{ name } </option>
              </select>
            </div>
          </div>
          <div class="col-md-5">
            <div class="form-group">
              <label>
                Enter project name
              </label>
              <input type = "text" class="form-control" name="name"/>
            </div>
          </div>
          <div class="col-md-2">
            <div class="form-group">
              <label>
                &nbsp;
              </label>
              <button class="form-control btn btn-primary">Create</button>
            </div>
          </div>
        </div>
      </form>
      </div>
    </div>
  </div>
</div>

<div each={ projects.filter(isCurrentProject) }>
  <issuetracker project= { this }></issuetracker>
</div>

<script>
  this.projects = opts.projects;
  this.currentProjectClientID = opts.currentProjectClientID;
  //var projectStorage = new Store("projects");

  add(e) {
		this.projects.push({ client_id: guid(), name: this.name.value});
    //projectStorage.dump(this.projects);
		this.name.value = '';
	}
  selectCurrentProject(e){
    this.currentProjectClientID = e.item.client_id;
  }

  isCurrentProject(project) {
    return project.client_id === this.currentProjectClientID;
  }
</script>
</project>
