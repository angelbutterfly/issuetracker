<app>
<div class={ debug: opts.debug }>
  <pre style='display:none'>
{ JSON.stringify(store, null, 2) }
  </pre>
  <div class="row">
    <div class="col-md-12">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class='panel-title'>New Project</h3>
        </div>
        <div class="panel-body">
            <form onsubmit={ add }>
          <div class="row">
            <div class="col-md-5">
              <div class="form-group">
                <label>
                  Select a project!
                </label>
                <select multiple class="form-control">
                  <option each={ projects } onclick = { selectCurrentProject }>{ title } </option>
                </select>
              </div>
            </div>
            <div class="col-md-5">
              <div class="form-group">
                <label>
                  Enter project name
                </label>
                <input type = "text" class="form-control" name="projectTitle"/>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <label>
                  &nbsp;
                </label>
                <button class="form-control btn btn-primary">Create</button>
              </div>
            </div>
          </div>
        </form>
        </div>
      </div>
    </div>
  </div>
  <div each={ projects }>
    <project opts= { title }/>
  </div>
  </div>
</div>
  <script>
    this.projects = opts.projects;
    add(e) {
      this.projects.push({title: this.projectTitle.value, issues: []})
      this.projectTitle.value = '';
    }
    remove(e) {
      var project = e.item;
      var index = this.projects.indexOf(project);
      this.projects.splice(index, 1);
    }
  </script>
  <style type="text/css">
    .debug pre {
      display: block !important;
      float:left;
      width: 400px;
      font-size: 10px;
    }
    .debug .app {
      margin-left: 450px;
    }
  </style>
</app>

<project>
  <div class="row">
    <div class="col-md-12">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">{ title } Issues</h3>
        </div>
        <div class="panel-body">
          <form onsubmit={ add }>
            <div class="row">
              <div class="col-md-3">
                <label> Select Priority
                </label>
                <select class="form-control">
                  <option>1</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5</option>
                </select>
              </div>
              <div class="col-md-3"><div class = "form-group">
                <label> Choose Date
                </label>
                <input  type="text" placeholder="Chose date" name="datepicker" class="datepicker form-control"></input></div>
              </div>
              <div class="col-md-4">
                <div class = "form-group">
                  <label>
                    Describe your Issue
                  </label>
                  <textarea class="form-control" name="issueTitle"></textarea>
                </div>
              </div>
              <div class="col-md-2"><div class="form-group">
                <label>

                </label>
                <button class="form-control btn btn-primary" id = "save_issue">Create</button>
              </div></div>

            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
  <div class = "row">
    <div class = "col-md-12">
      <table class = "table table-bordered">
        <thead>
          <tr>
            <th>
              Done
            </th>
            <th>
              Description
            </th>
            <th>
              Date
            </th>
            <th>
              Delete
            </th>
          </tr>
        </thead>
        <tbody>
          <tr each={ this.issues } data-is="issue" class= { completed: done }>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <script>
    add(e) {
      this.issues.push({title: this.issueTitle.value, due_date: this.datepicker.value})
      this.issueTitle.value = '';
    }

    remove(e) {
      var issue = e.item;
      var index = this.issues.indexOf(issue);
      this.issues.splice(index, 1);
      this.parent.update();
    }

    toggle(e){
      var item = e.item;
      item.done = !item.done;
      this.parent.update();
      return true;
    }
  </script>
</project>

<issue>
  <td>
    <div class="form-check">
      <label class="form-check-label">
        <input class="form-check-input" type="checkbox" value="" checked={ done } onclick = { parent.toggle }></input>
      </label>
    </div>
  </td>
  <td class = "description">
    { title }
  </td>
  <td class = "date">
    { due_date }
  </td>
  <td>
    <span class="glyphicon glyphicon-trash" aria-hidden="true" onclick = {parent.remove }></span>
  </td>
  </script>
</issue>
